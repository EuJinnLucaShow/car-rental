{"version":3,"file":"static/js/677.9f21865c.chunk.js","mappings":"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","sources":["pages/CatalogPage/CatalogPage.styled.jsx","pages/CatalogPage/CatalogPage.jsx"],"sourcesContent":["import styled from '@emotion/styled';\n\nexport const WrapperSelect = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  padding-left: 128px;\n  padding-right: 128px;\n`;\n\nexport const Wrapper = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  gap: 50px 29px;\n  padding-left: 128px;\n  padding-right: 128px;\n  margin-top: 50px;\n  margin-bottom: 50px;\n`;\n","import { useEffect, useState } from 'react';\nimport Button from '@mui/material/Button';\n\nimport CardItem from 'components/CardItem/CardItem';\nimport SelectForm from 'components/Select/Select';\nimport {\n  useGetAdvertsQuery,\n  useGetCarsByPageQuery,\n} from '../../redux/operations';\nimport { Loader } from 'components/Loader/Loader';\n\nimport { Wrapper, WrapperSelect } from './CatalogPage.styled';\n\nfunction CatalogPage() {\n  const [page, setPage] = useState(1);\n  const [catalog, setCatalog] = useState([]);\n  const { data, error, isLoading, isFetching } = useGetCarsByPageQuery(page);\n  const { data: allAdverts } = useGetAdvertsQuery();\n\n  const [filters, setFilters] = useState({\n    make: '',\n    filteredPrices: [],\n    minMileage: '',\n    maxMileage: '',\n  });\n  const [filteredAdverts, setFilteredAdverts] = useState(null);\n  const [isFiltering, setIsFiltering] = useState(false);\n\n  const loadMore = () => {\n    setPage(page + 1);\n  };\n\n  useEffect(() => {\n    if (data) {\n      setCatalog(prevCatalog => [...prevCatalog, ...data]);\n    }\n  }, [data]);\n\n  useEffect(() => {\n    if (isFiltering) {\n      if (\n        filters.make ||\n        filters.filteredPrices.length > 0 ||\n        filters.minMileage ||\n        filters.maxMileage\n      ) {\n        const filteredAdverts = allAdverts.filter(advert => {\n          if (filters.make && advert.make !== filters.make.value) {\n            return false;\n          }\n          if (\n            filters.filteredPrices.length > 0 &&\n            !filters.filteredPrices.some(\n              priceObj => priceObj.value === advert.rentalPrice.replace('$', '')\n            )\n          ) {\n            return false;\n          }\n          if (filters.minMileage && advert.mileage < filters.minMileage) {\n            return false;\n          }\n          if (filters.maxMileage && advert.mileage > filters.maxMileage) {\n            return false;\n          }\n          return true;\n        });\n\n        setFilteredAdverts(filteredAdverts);\n      } else {\n        setFilteredAdverts([]);\n      }\n    }\n  }, [filters, allAdverts, isFiltering]);\n\n  const makes = allAdverts\n    ? [...new Set(allAdverts.map(advert => advert.make))]\n    : [];\n  const prices = allAdverts\n    ? [\n        ...new Set(\n          allAdverts.map(advert => advert.rentalPrice.replace('$', ''))\n        ),\n      ]\n    : [];\n  const mileage = allAdverts\n    ? [...new Set(allAdverts.map(advert => advert.mileage))]\n    : [];\n  const minMileage = Math.min(...mileage);\n  const maxMileage = Math.max(...mileage);\n\n  return (\n    <>\n      <WrapperSelect>\n        <SelectForm\n          makes={makes}\n          prices={prices}\n          minMileage={minMileage}\n          maxMileage={maxMileage}\n          onFilterChange={newFilters => {\n            setFilters(newFilters);\n            setIsFiltering(true);\n          }}\n          filters={filters}\n        />\n      </WrapperSelect>\n      <Wrapper>\n        {isFiltering ? (\n          filteredAdverts !== null && filteredAdverts.length > 0 ? (\n            filteredAdverts.map((car, index) => (\n              <CardItem key={index} data={car} />\n            ))\n          ) : (\n            <div>No results found for the selected criteria.</div>\n          )\n        ) : error ? (\n          <>Oops, there was an error...</>\n        ) : isLoading ? (\n          <Loader />\n        ) : catalog.length > 0 ? (\n          catalog.map((car, index) => <CardItem key={index} data={car} />)\n        ) : null}\n        {!isFiltering && data && data.length >= 8 && (\n          <Button variant=\"text\" onClick={loadMore} disabled={isFetching}>\n            Load more\n          </Button>\n        )}\n      </Wrapper>\n    </>\n  );\n}\n\nexport default CatalogPage;\n"],"names":["WrapperSelect","styled","div","_templateObject","_taggedTemplateLiteral","Wrapper","_templateObject2","_useState","useState","_useState2","_slicedToArray","page","setPage","_useState3","_useState4","catalog","setCatalog","_useGetCarsByPageQuer","useGetCarsByPageQuery","data","error","isLoading","isFetching","allAdverts","useGetAdvertsQuery","_useState5","make","filteredPrices","minMileage","maxMileage","_useState6","filters","setFilters","_useState7","_useState8","filteredAdverts","setFilteredAdverts","_useState9","_useState10","isFiltering","setIsFiltering","useEffect","prevCatalog","concat","_toConsumableArray","length","filter","advert","value","some","priceObj","rentalPrice","replace","mileage","makes","Set","map","prices","Math","min","apply","max","_jsxs","_Fragment","children","_jsx","SelectForm","onFilterChange","newFilters","car","index","CardItem","Loader","Button","variant","onClick","disabled"],"sourceRoot":""}